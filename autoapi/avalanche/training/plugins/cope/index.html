

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>avalanche.training.plugins.cope &mdash; Avalanche 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../../../../_static/css/mystyle.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../../genindex/" />
    <link rel="search" title="Search" href="../../../../../search/" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../">
          

          
            
            <img src="../../../../../_static/avalanche_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Avalanche API:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../../">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche</span></code></a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../../#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../../benchmarks/"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche.benchmarks</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../evaluation/"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche.evaluation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../logging/"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche.logging</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../models/"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche.models</span></code></a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../core/"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche.core</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../#package-contents">Package Contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../#avalanche.__version__">__version__</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../">Avalanche</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../" class="icon icon-home"></a> &raquo;</li>
        
      <li><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche.training.plugins.cope</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../../_sources/autoapi/avalanche/training/plugins/cope/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-avalanche.training.plugins.cope">
<span id="avalanche-training-plugins-cope"></span><h1><a class="reference internal" href="#module-avalanche.training.plugins.cope" title="avalanche.training.plugins.cope"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche.training.plugins.cope</span></code></a><a class="headerlink" href="#module-avalanche.training.plugins.cope" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this headline">¶</a></h2>
<div class="section" id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h3>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#avalanche.training.plugins.cope.CoPEPlugin" title="avalanche.training.plugins.cope.CoPEPlugin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoPEPlugin</span></code></a></p></td>
<td><p>Continual Prototype Evolution plugin.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#avalanche.training.plugins.cope.L2Normalization" title="avalanche.training.plugins.cope.L2Normalization"><code class="xref py py-obj docutils literal notranslate"><span class="pre">L2Normalization</span></code></a></p></td>
<td><p>Module to L2-normalize the input. Typically used in last layer to</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#avalanche.training.plugins.cope.PPPloss" title="avalanche.training.plugins.cope.PPPloss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PPPloss</span></code></a></p></td>
<td><p>Pseudo-Prototypical Proxy loss (PPP-loss).</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="avalanche.training.plugins.cope.CoPEPlugin">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">avalanche.training.plugins.cope.</span></code><code class="sig-name descname"><span class="pre">CoPEPlugin</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/training/plugins/cope/#CoPEPlugin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.training.plugins.cope.CoPEPlugin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../strategy_plugin/#avalanche.training.plugins.strategy_plugin.StrategyPlugin" title="avalanche.training.plugins.strategy_plugin.StrategyPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">avalanche.training.plugins.strategy_plugin.StrategyPlugin</span></code></a></p>
<p>Continual Prototype Evolution plugin.
Each class has a prototype for nearest-neighbor classification.
The prototypes are updated continually with an exponentially moving average,
using class-balanced replay to keep the prototypes up-to-date.
The embedding space is optimized using the PseudoPrototypicalProxy-loss,
exploiting both prototypes and batch information.</p>
<p>This plugin doesn’t use task identities in training or eval
(data incremental) and is designed for online learning (1 epoch per task).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mem_size</strong> – max number of input samples in the replay memory.</p></li>
<li><p><strong>n_classes</strong> – total number of classes that will be encountered. This</p></li>
</ul>
</dd>
</dl>
<p>is used to output predictions for all classes, with zero probability
for unseen classes.
:param p_size: The prototype size, which equals the feature size of the
last layer.
:param alpha: The momentum for the exponentially moving average of the
prototypes.
:param T: The softmax temperature, used as a concentration parameter.</p>
<dl class="py method">
<dt id="avalanche.training.plugins.cope.CoPEPlugin.before_training">
<code class="sig-name descname"><span class="pre">before_training</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/training/plugins/cope/#CoPEPlugin.before_training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.training.plugins.cope.CoPEPlugin.before_training" title="Permalink to this definition">¶</a></dt>
<dd><p>Enforce using the PPP-loss and add a NN-classifier.</p>
</dd></dl>

<dl class="py method">
<dt id="avalanche.training.plugins.cope.CoPEPlugin.before_training_exp">
<code class="sig-name descname"><span class="pre">before_training_exp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/training/plugins/cope/#CoPEPlugin.before_training_exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.training.plugins.cope.CoPEPlugin.before_training_exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Random retrieval from a class-balanced memory.
Dataloader builds batches containing examples from both memories and
the training dataset.</p>
</dd></dl>

<dl class="py method">
<dt id="avalanche.training.plugins.cope.CoPEPlugin.after_forward">
<code class="sig-name descname"><span class="pre">after_forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/training/plugins/cope/#CoPEPlugin.after_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.training.plugins.cope.CoPEPlugin.after_forward" title="Permalink to this definition">¶</a></dt>
<dd><p>After the forward we can use the representations to update our running
avg of the prototypes. This is in case we do multiple iterations of
processing on the same batch.</p>
<p>New prototypes are initialized for previously unseen classes.</p>
</dd></dl>

<dl class="py method">
<dt id="avalanche.training.plugins.cope.CoPEPlugin.after_training_exp">
<code class="sig-name descname"><span class="pre">after_training_exp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/training/plugins/cope/#CoPEPlugin.after_training_exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.training.plugins.cope.CoPEPlugin.after_training_exp" title="Permalink to this definition">¶</a></dt>
<dd><p>After the current experience (batch), update prototypes and
store observed samples for replay.</p>
</dd></dl>

<dl class="py method">
<dt id="avalanche.training.plugins.cope.CoPEPlugin.after_eval_iteration">
<code class="sig-name descname"><span class="pre">after_eval_iteration</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/training/plugins/cope/#CoPEPlugin.after_eval_iteration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.training.plugins.cope.CoPEPlugin.after_eval_iteration" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert output scores to probabilities for other metrics like
accuracy and forgetting. We only do it at this point because before
this,we still need the embedding outputs to obtain the PPP-loss.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="avalanche.training.plugins.cope.L2Normalization">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">avalanche.training.plugins.cope.</span></code><code class="sig-name descname"><span class="pre">L2Normalization</span></code><a class="reference internal" href="../../../../../_modules/avalanche/training/plugins/cope/#L2Normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.training.plugins.cope.L2Normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.Module</span></code></p>
<p>Module to L2-normalize the input. Typically used in last layer to
normalize the embedding.</p>
<p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt id="avalanche.training.plugins.cope.L2Normalization.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tensor</span><a class="reference internal" href="../../../../../_modules/avalanche/training/plugins/cope/#L2Normalization.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.training.plugins.cope.L2Normalization.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="avalanche.training.plugins.cope.PPPloss">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">avalanche.training.plugins.cope.</span></code><code class="sig-name descname"><span class="pre">PPPloss</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_mem</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/training/plugins/cope/#PPPloss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.training.plugins.cope.PPPloss" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Pseudo-Prototypical Proxy loss (PPP-loss).
This is a contrastive loss using prototypes and representations of the
samples in the batch to optimize the embedding space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_mem</strong> – dictionary with keys the prototype identifier and
values the prototype tensors.</p></li>
<li><p><strong>T</strong> – temperature of the softmax, serving as concentration
density parameter.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="avalanche.training.plugins.cope.PPPloss.__call__">
<code class="sig-name descname"><span class="pre">__call__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/training/plugins/cope/#PPPloss.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.training.plugins.cope.PPPloss.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>The loss is calculated with one-vs-rest batches Bc and Bk,
split into the attractor and repellor loss terms.
We iterate over the possible batches while accumulating the losses per
class c vs other-classes k.</p>
</dd></dl>

<dl class="py method">
<dt id="avalanche.training.plugins.cope.PPPloss.attractor">
<code class="sig-name descname"><span class="pre">attractor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Bc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/training/plugins/cope/#PPPloss.attractor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.training.plugins.cope.PPPloss.attractor" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the attractor loss terms for all instances in xc.
:param pc: Prototype of the same class c.
:param pk: Prototoypes of the other classes.
:param Bc: Batch of instances of the same class c.
:return: Sum_{i, the part of same class c} log P(c|x_i^c)</p>
</dd></dl>

<dl class="py method">
<dt id="avalanche.training.plugins.cope.PPPloss.repellor">
<code class="sig-name descname"><span class="pre">repellor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Bc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Bk</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/training/plugins/cope/#PPPloss.repellor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.training.plugins.cope.PPPloss.repellor" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the repellor loss terms for all pseudo-prototype instances in Bc.
:param pc: Actual prototype of the same class c.
:param pk: Prototoypes of the other classes (k).
:param Bc: Batch of instances of the same class c. Acting as
pseudo-prototypes.
:param Bk: Batch of instances of other-than-c classes (k).
:return: Sum_{i, part of same class c} Sum_{x_j^k} log 1 - P(c|x_j^k)</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, ContinualAI.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>